/**
 * Terrific JavaScript Framework v1.0.0
 * http://terrifically.org
 *
 * Copyright 2011, Remo Brunschwiler
 * MIT Licensed.
 *
 * Date: Fri, 13 May 2011 07:06:59 GMT
 *
 *
 * Includes:
 * Simple JavaScript Inheritance
 * By John Resig http://ejohn.org/
 * MIT Licensed.
 *
 * @module Tc
 * 
 */
var Tc=Tc||{};Tc.$=jQuery.noConflict(!1),function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function g(){!a&&this.init&&this.init.apply(this,arguments)}var d=this.prototype;a=!0;var e=new this;a=!1;for(var f in c)e[f]=typeof c[f]=="function"&&typeof d[f]=="function"&&b.test(c[f])?function(a,b){return function(){var c=this._super;this._super=d[a];var e=b.apply(this,arguments);this._super=c;return e}}(f,c[f]):c[f];g.prototype=e,g.constructor=g,g.extend=arguments.callee;return g}}(),Tc.Config={dependencyPath:{library:"/js/libraries/dynamic/",plugin:"/js/plugins/dynamic/",util:"/js/utils/dynamic/"}},function(a){Tc.Application=Class.extend({init:function(b,c){this.config=a.extend(Tc.Config,c),this.$ctx=b||a("body"),this.modules=[],this.connectors={},this.wildcardComponents=[],this.sandbox=new Tc.Sandbox(this,this.config)},registerModules:function(b){var c=this,d=[];b=b||this.$ctx,a(".mod",b).each(function(){var b=a(this),e=b.attr("class").split(" ");if(e.length>1){var f,g=[],h=[];for(var i=0,j=e.length;i<j;i++){var k=a.trim(e[i]);k.indexOf("mod")===0&&k.length>3?f=k.substr(3):k.indexOf("skin")===0&&g.push(k.substr(4).replace(f,""))}if(b.attr("data-connectors")){h=b.attr("data-connectors").split(",");for(var i=0,j=h.length;i<j;i++)h[i]=a.trim(h[i])}f&&Tc.Module[f]&&d.push(c.registerModule(b,f,g,h))}});return d},unregisterModules:function(b){var c=this.connectors,d=this.wildcardComponents;b=b||this.modules;if(b===this.modules)this.wildcardComponents=[],this.connectors=[],this.modules=[];else for(var e=0,f=b.length;e<f;e++){var g=b[e],h;for(var i in c)c[i].unregisterComponent(g);h=a.inArray(g,d),delete d[h],h=a.inArray(g,this.modules),delete this.modules[h]}},start:function(b){var c=this.wildcardComponents,d=this.connectors;b=b||this.modules;for(var e=0,f=b.length;e<f;e++)b[e].start();for(var e=0,f=c.length;e<f;e++){var g=c[e];if(a.inArray(g,b)>-1)for(var h in d)g.attachConnector(d[h]),d[h].registerComponent(g,"*")}},stop:function(a){a=a||this.modules;for(var b=0,c=a.length;b<c;b++)a[b].stop()},registerModule:function(a,b,c,d){var e=this.modules;b=b||null,c=c||[],d=d||[];if(b&&Tc.Module[b]){var f=e.length;a.data("id",f),e[f]=new Tc.Module[b](a,this.sandbox,f);for(var g=0,h=c.length;g<h;g++){var i=c[g];Tc.Module[b][i]&&(e[f]=e[f].getDecoratedModule(b,i))}for(var g=0,h=d.length;g<h;g++)this.registerConnection(d[g],e[f]);return e[f]}return null},registerConnection:function(a,b){var c=a.replace(/[0-9]+[a-zA-Z]*$/,""),d=a.replace(/[a-zA-Z]*$/,"").replace(/^[a-zA-Z]*/,""),e=a.replace(/^[a-zA-Z]*[0-9]*/,"");if(d==="*"&&e==="*")this.wildcardComponents.push(b);else{var f=this.connectors;f[d]||(c===""?f[d]=new Tc.Connector(d):Tc.Connector[c]&&(f[d]=new Tc.Connector[c](d))),f[d]&&(b.attachConnector(f[d]),f[d].registerComponent(b,e))}}})}(Tc.$),function(a){Tc.Sandbox=Class.extend({init:function(b,c){this.application=b,this.config=c,this.dependencies=[],this.afterBindingCallbacks=[],this.firstScript=a("script").get(0)},addModules:function(a){var b=[],c=this.application;a&&(b=c.registerModules(a),c.start(b));return b},removeModules:function(a){var b=this.application;a&&(b.stop(a),b.unregisterModules(a))},getModuleById:function(a){var b=this.application;if(b.modules[a]!==undefined)return b.modules[a];throw new Error("the module with the id "+a+" does not exist")},getConfig:function(){return this.config},getConfigParam:function(a){var b=this.config;if(b.name!==undefined)return b.name;throw new Error("the config param "+a+" does not exist")},loadDependency:function(a,b,c,d){var e=this;d=d||"none",b=b||"plugin";if(e.dependencies[a]&&e.dependencies[a].state==="requested")e.dependencies[a].callbacks.push(function(){c(d)});else if(e.dependencies[a]&&e.dependencies[a].state==="loaded")c(d);else{e.dependencies[a]={state:"requested",callbacks:[]};var f;switch(b){case"library":case"plugin":case"util":f=this.config.dependencyPath[b];break;case"url":f="";break;case"default":f=""}var g=document.createElement("script"),h=this.firstScript;g.src=f+a,g.onreadystatechange=g.onload=function(){var b=g.readyState;if(!b||b=="loaded"||b=="complete"){e.dependencies[a].state="loaded",c(d);var f=e.dependencies[a].callbacks;for(var h=0,i=f.length;h<i;h++)f[h]();g.onload=g.onreadystatechange=null}},h.parentNode.insertBefore(g,h)}},readyForAfterBinding:function(a){var b=this.afterBindingCallbacks;b.push(a);if(this.application.modules.length==b.length)for(var c=0;c<b.length;c++)b[c]()}})}(Tc.$),function(a){Tc.Module=Class.extend({init:function(a,b,c){this.$ctx=a,this.modId=c,this.connectors=[],this.dependencyCounter={beforeBinding:0,onBinding:1,afterBinding:1},this.sandbox=b},start:function(){this.dependencies&&this.dependencies(),this.initBeforeBinding()},stop:function(){var b=this.$ctx;a("*",b).unbind().removeData(),b.unbind().removeData()},initBeforeBinding:function(){var a=this;this.checkDependencies("beforeBinding",function(){a.beforeBinding?a.beforeBinding(function(){a.beforeBindingCallback()}):a.beforeBindingCallback()})},beforeBindingCallback:function(){this.dependencyCounter.onBinding--,this.initOnBinding()},initOnBinding:function(){var a=this;this.checkDependencies("onBinding",function(){a.onBinding&&a.onBinding(),a.dependencyCounter.afterBinding--,a.initAfterBinding()})},initAfterBinding:function(){var a=this;this.checkDependencies("afterBinding",function(){a.sandbox.readyForAfterBinding(function(){a.afterBinding&&a.afterBinding()})})},checkDependencies:function(a,b){this.dependencyCounter[a]===0&&b()},require:function(b,c,d,e){c=c||"plugin",d=d||"onBinding",e=e===!1?!1:!0,this.dependencyCounter[d]++;var f=a.proxy(function(){if(e){var a=this;this.dependencyCounter[d]--,a["init"+Tc.Utils.String.capitalize(d)]()}},this.sandbox.getModuleById(this.modId));this.sandbox.loadDependency(b,c,f,d)},fire:function(b,c,d){var e=this,f=this.connectors;c=c||{},b=Tc.Utils.String.capitalize(b),a.each(f,function(){var a=this,f=function(){typeof d=="function"&&d(),a.notify(e,"after"+b,c)};a.notify(e,"on"+b,c,f)&&f()}),f.length<1&&typeof d=="function"&&d()},attachConnector:function(a){this.connectors.push(a)},getDecoratedModule:function(a,b){if(Tc.Module[a][b]){var c=Tc.Module[a][b];c.prototype=this,c.prototype.constructor=Tc.Module[a][b];return new c(this)}return null}})}(Tc.$),function(a){Tc.Connector=Class.extend({init:function(a){this.connectorId=a,this.components=[]},registerComponent:function(a,b){b=b||"standard",this.components.push({component:a,role:b})},unregisterComponent:function(a){var b=this.components;for(var c in b)b[c].component===a&&delete b[c]},notify:function(a,b,c,d){var e=!0,f=this.components;for(var g in f)f[g].component!==a&&f[g].component[b]&&f[g].component[b](c,d)===!1&&(e=!1);return e}})}(Tc.$),Tc.Utils={},function(a){Tc.Utils.String={capitalize:function(a){return a.substr(0,1).toUpperCase().concat(a.substr(1))}}}(Tc.$)